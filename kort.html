<!DOCTYPE html>

<html lang="da">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<!--
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'">
-->
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
   <meta name="theme-color" content="#a8b2b3"> 
	
	
<meta name="description" content="Kirsten Poulsgaard">
   

    <title>Kirsten Poulsgaard - Kort</title>
	<link rel="stylesheet" href="/style.css">
    <script src="/navbar.js" defer></script>
    <script src="/app.js" defer></script>


    <style>
        input[type=number] {
            width: 80px;
        }
        input[type=submit] {
            padding: 8px;
            margin-top: 12px;;
        }

        #formular {
            border:solid black 2px !important;
            background-color: antiquewhite;
            padding: 10px;
        }

        #ialtparagraph {
            display: none;
            margin-top: 20px;
        }
    </style>

</head>

<body>
    <header>
        <nav class="navbar">
        </nav>
    </header>
    <section>
        <h1>Bestilling af kort</h1>
        <div class="txtcontent">
        </div>    


        <form  id="myForm" method="get" enctype="text/plain">
      
        <br>


        <div id="formular" >
            <h2 >Bestillingsformular</h2>
            <table>
                <tr>
                    <td><img src="/billeder/1998.jpeg" width="200" alt="kort01"></td>
                    <td>Kort 01:<br><input class="kortantal" type="number" min="0" max="1000" name="Kort 01" " placeholder="Antal" inputmode="numeric" pattern="[0-9]*"></td>
                </tr>

                <tr>
                    <td><img src="/billeder/1997.jpeg" width="200" alt="kort02"></td>
                    <td>Kort 02:<br><input class="kortantal" type="number" min="0" max="1000" name="Kort 02"  placeholder="Antal" inputmode="numeric" pattern="[0-9]*"></td>
                </tr>

                <tr>
                    <td><img src="/billeder/2007.jpeg" width="200" alt="kort03"></td>
                    <td>Kort 03:<br><input class="kortantal" type="number" min="0" max="1000" name="Kort 03"   placeholder="Antal" inputmode="numeric" pattern="[0-9]*"></td>
                </tr>

                <tr>
                    <td><img src="/billeder/2004.jpeg" width="200" alt="kort04"></td>
                    <td>Kort 04:<br><input class="kortantal" type="number" min="0" max="1000" name="Kort 04"   placeholder="Antal" inputmode="numeric" pattern="[0-9]*"></td>
                </tr>

                <tr>
                    <td><img src="/billeder/2003.jpeg" width="200" alt="kort05"></td>
                    <td>Kort 05:<br><input class="kortantal" type="number" min="0" max="1000" name="Kort 05"   placeholder="Antal" inputmode="numeric" pattern="[0-9]*"></td>
                </tr>

                <tr>
                    <td><img src="/billeder/1999.jpeg" width="200" alt="kort06"></td>
                    <td>Kort 06:<br><input class="kortantal" type="number" min="0" max="1000" name="Kort 06"   placeholder="Antal" inputmode="numeric" pattern="[0-9]*"></td>
                </tr>

                <tr>
                    <td><img src="/billeder/1995.jpeg" width="200" alt="kort07"></td>
                    <td>Kort 07:<br><input class="kortantal" type="number" min="0" max="1000" name="Kort 07"   placeholder="Antal" inputmode="numeric" pattern="[0-9]*"></td>
                </tr>

                <tr>
                    <td><img src="/billeder/1993.jpeg" width="200" alt="kort08"></td>
                    <td>Kort 08:<br><input class="kortantal" type="number" min="0" max="1000" name="Kort 08"   placeholder="Antal" inputmode="numeric" pattern="[0-9]*"></td>
                </tr>

                <tr>
                    <td><img src="/billeder/2002.jpeg" width="200" alt="Kort 09"></td>
                    <td>Kort 09:<br><input class="kortantal" type="number" min="0" max="1000" name="Kort 09"   placeholder="Antal" inputmode="numeric" pattern="[0-9]*"></td>
                </tr>

                <tr>
                    <td><img src="/billeder/2032.jpeg" width="200" alt="Kort 10"></td>
                    <td>Kort 10:<br><input class="kortantal" type="number" min="0" max="1000" name="Kort 10"  placeholder="Antal" inputmode="numeric" pattern="[0-9]*"></td>
                </tr>



            </table>

            <p id="ialtparagraph">

                        <input type="text" name="name" id="name" placeholder="Navn" required> <br/>            
                        <input type="text" name="address" id="addresse" placeholder="Addresse" required>  <br/>                                          
                        <input type="text" name="zip" id="zip" placeholder="Postnr. og by" required> <br/> 
                         <br/>  


                   <span id="numberOfCarts">0</span> kort á <span id="enhedspris">0</span> kr. = <span id="prisforkortene"></span> kr.<br>
                   Forsendelse <span id="forsendelse">39</span> kr. (fri forsendelse ved køb for over 400 kr.)<br>
                   I alt <span id="prisialt"></span> kr. <br>             
                <input type="submit" value="Åben formular i mail">
            </p>
        </div>
    </section>

    <footer>
        
    </footer>
</body>

<script>

document.addEventListener('DOMContentLoaded',()=>{
    document.getElementById("myForm").addEventListener("submit",handleForm);
})

    const numbers=document.querySelectorAll("input[type=number]");
    const numberOfCarts=document.getElementById("numberOfCarts");
    const enhedspristxt=document.getElementById("enhedspris");
    const prisforkortene=document.getElementById("prisforkortene");
    const ialtparagraph=document.getElementById("ialtparagraph");
    const forsendelse=document.getElementById("forsendelse");
    const prisialt=document.getElementById("prisialt");

    numbers.forEach(element => {
        element.addEventListener("change", ()=>{           
            countCarts();
        });
        
    });

    function countCarts(){
        let counter=0;
        let enhedspris=0;
        let forsendelsespris=39;

        numbers.forEach(element => {
            
            if(element.value){
                counter=counter+parseInt(element.value);
            }            
        });     

        if(counter>0){
            ialtparagraph.style.display="block";
            if(counter<3){
                enhedspris=20;
            }
            else if(counter<10) {
                enhedspris=15;
            }
            else {
                enhedspris=12;
            }
            enhedspristxt.innerText=enhedspris;

            //Ved køb for mere end 400 kr. er der fri forsendelse
            if(counter*enhedspris>=400){
                forsendelsespris=0;                
            }

        }
        else {
            ialtparagraph.style.display="none";
        }

        numberOfCarts.innerText=counter;
        prisforkortene.innerText=counter*enhedspris;
        forsendelse.innerText=forsendelsespris;
        prisialt.innerText=counter*enhedspris+forsendelsespris;
    }



    function handleForm(ev){
        ev.preventDefault();
        let myForm=ev.target;
        let fd=new FormData(myForm);

        let bestilling="";
        for(let key of fd.keys()){            
            if(key.indexOf("Kort")==0 && fd.get(key)>"0"){
                bestilling=bestilling + `${key}: ${fd.get(key)} stk.\n`
                console.log(key,fd.get(key));
            }
        }


let uri = `mailto:kirstenpoulsgaard@gmail.com?subject=Bestilling af kort&body=

Bestilling:
==============================
${bestilling}

Betaling:
==============================
I alt antal kort: ${numberOfCarts.innerText}
Pris pr. kort: ${enhedspristxt.innerText}
Pris for kortene: ${prisforkortene.innerText} kr.
Forsendelse: ${forsendelse.innerText} kr.
Pris i alt: ${prisialt.innerText} kr.

Betaling fortages vha. MobilPay på 30118733 Kirsten Poulsgaard.

Kort sendes til denne adresse:
==============================
Navn: ${fd.get("name")}
Adresse: ${fd.get("address")}
Postnr. og by: ${fd.get("zip")}





`;

let encoded = encodeURI(uri);
window.open(encoded);
}


</script>


</html>